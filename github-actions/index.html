<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="shortcut icon" href="https://adrochoa.github.io/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.min.css">

    <title>Github Actions</title>
</head>
<body><header id="banner">
    <h2><a href="https://adrochoa.github.io">Math, Music, Misc.</a></h2>
    <nav>
        <ul>
            <li>
                <a href="/" title="posts">posts</a>
            </li><li>
                <a href="/about/" title="about">about</a>
            </li>
        </ul>
    </nav>
</header>
<main id="content">
<section id="main">
  <h1 id="title">Github Actions</h1>
  <div>
        <article id="content">
           <p><em>To see an earlier method I used that relies more heavily on git and submodules, see my first post <a href="/this-static-website/">here</a>.</em></p>
<p>I have recently switched workflows to utilize Github Actions<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.
There are many Github Actions that can be performed on a repository.
For this website, I am using actions from Shohei Ueda aka peaceiris<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>.
Specifically, I use <code>actions-gh-pages</code> and <code>actions-hugo</code>.
These are absolutely fantastic for my workflow since it enables me to more easily modify and post from my iPhone on the go by using iSH<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>, which provides a GNU/Linux-like shell terminal complete with git, text editors and other command line goodies.
The action is defined in a YAML file in a branch in the git repository on which you would like to do something with.
Actions can do many things including running build jobs, creating new branches and opening pull requests.
Additionally one could run tests, automating an entire continuous integration, continuous development (CI/CD) process.
The action described here is relatively simple compared to what is possible though.
Basically, I ditch the old setup with a single repository, <code>username.github.io</code>.
The <code>source</code> branch contains the necessary Hugo folder configuration described in <a href="/this-static-website/">my first post on creating this static website</a>.
The <code>main</code> branch still has the Hugo-generated HTML files for the static site.
Additionally, there is a <code>gh-pages</code> branch that stages any newly pushed content.
I can then open a pull request from <code>gh-pages</code> to <code>main</code>, review the update and finally merge and my site is rendered live in about a minute.
The one caveat with this setup is that the <code>source</code> branch is somewhat unrelated to the other branches which contain site content but this is a small sacrifice for the convenience that this workflow brings.
In my <code>source</code> branch is the following YAML:</p>
<pre><code>#.github/workflows/gh-pages.yml
name: github pages

on:
  push:
    branches:
      - source  # Set a branch to deploy

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: true  # Fetch Hugo themes (true OR recursive)
          fetch-depth: 0    # Fetch all history for .GitInfo and .Lastmod

      - name: Setup Hugo
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: 'latest'
          extended: true

      - name: Build
        run: hugo

      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        if: github.ref == 'refs/heads/source'
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
</code></pre>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://github.com/features/actions">https://github.com/features/actions</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://github.com/peaceiris">https://github.com/peaceiris</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p><a href="https://ish.app/">https://ish.app/</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

        </article>
  </div>


</section>
<aside id="meta">
    <div>
    <section>
      <h4 id="date"> Wed Jul 13, 2022 </h4>
      <h5 id="wordcount"> 371 Words </h5>
    </section>
    
    
    </div>
    <div>
        
          <a class="previous" href="https://adrochoa.github.io/favorite-sites/"> Favorite Sites</a>
        
        
          <a class="next" href="https://adrochoa.github.io/this-static-website/"> This Static Website</a>
        
    </div>
</aside>

        </main><footer id="footer">
    
</footer>
</body>
</html>
